%factor graph, trivial example. 

p_ab = [
    0.5 0.5; 
    0.25 0.75
    ] ;

p_cb = [
    0 1 ;
    1 0
    ] ;

p_dc = [
    0.5 0.5 ;
    0.25 0.75
    ] ;

p_b = [
    0.5 0.5 ] ;

%function g = p_b * p_ab * p_bc * p_dc

for i = 0:15
    bi = dec2bin(i, 4) ;
    a = bin(1) + 1;
    b = bin(2) + 1;
    c = bin(3) + 1;
    d = bin(4) + 1;
    g(i) = p_b(b) * p_ab(b,a) * p_bc(
end